\documentclass{article}

% Packages for additional functionality
\usepackage{amsmath} % For mathematical equations
\usepackage{graphicx} % For including images
\usepackage{hyperref} % For hyperlinks
\usepackage{float}
\usepackage{subfigure}

\newcommand{\para}{\vspace{8pt}} % New paragraph command

\setlength{\parindent}{0pt} % No indentation for new paragraphs

\begin{document}
\title{Optimal Hedging with Advanced Delta Modelling }
\author{Joseph Kirk}
\date{\today}

\maketitle

\newpage
\tableofcontents

\newpage
\section{Introduction}

\subsection{Preamble}
This report is prepared to satisfy the requirements of the CQF assignment \textit{Optimal Hedging with Advanced Delta Modelling}. Three topics are studied.

\para
The first investigation uses Geometric Brownian Motion as an example to introduce Monte Carlo methods and variance reduction techniques. 
Specifically we study the effect of antithetic variates, sobol sequences and the Brownian Bridge to reduce the number of paths required to converge on the Black Scholes 
price of a European Call Option.

\para
The second study looks at the affect of hedging with actual and implied volatility under the condition that future realised volatility is
above implied volatility.  We demonstrate through simulation and prove with mathematical workings that hedging with the actual volatility leads to a known value of total 
P\&L.  

\para
We conclude the report by partially replicating the study conducted by John C. Hull and Alan White \cite{hull}. Using 2023 implied volatility for SPX options (provided by OptionsDX)
we fit the minimum variance delta (MVD) model. This model anticipates the change in magnitude of implied volatility and applies a correction to the Black Scholes delta.

\subsection{Code}

The Python code used to generate the data and plots has been provided alongside this report. Core functionality has been coded as reusable modules and the experiments
are available as Jupyter notebooks. There are more details in the README of the code package.  External packages used are:

\begin{itemize}
    \item numpy / pandas - SIMD vectorized operations and data manipulation
    \item scikit-learn - Linear regression
    \item matplotlib - Plot generation for reports
    \item scipy - Normal distribution and Sobol sequences
\end{itemize}

All other methods have been implemented from scratch. The scientific libraries are so commonly used that they are considered part of the standard library in Python.

\newpage

\section{Monte Carlo Variance Reduction}

Monte Carlo methods are a class of computational algorithms that rely on repeated random sampling to obtain numerical results. It is particularly prevelant in the field of finance
where many financial models do not have closed form solutions. While European options can be priced using the Black-Scholes formula (which is derived from Geometric Brownian Motion), more complex 
products such as American options, that can be exercised at any point, require a numerical approach. 

\para
To price an option using Monte Carlo methods, we must compute the fair value of said option. This is the present value of the expected payoff at expiry under a risk-neutral random walk. 

\begin{enumerate}
    \item Simulate the risk-neutral random walk starting at today's value of the asset, $S_0$, over the required time horizon. This gives one realization of the underlying price path.
    \item For this realization calculate the option payoff.
    \item Perform many more such realizations over the time horizon.
    \item Calculate the average payoff over all realizations.
    \item Take the present value of this average, this is the option value.
\end{enumerate}

Monte Carlo is a widely accepted method for pricing options since it is simple to implement and can be used for products with complex path dependency. However, it can be computationally expensive.  If we 
can reduce the variance of the simulated path then we can reduce the number of paths we need to calculate. This is the aim of variance reduction techniques.  To study variance reduction techniques we use 
the motivating example of pricing a European Call Option whose underlying follows Geometric Brownian Motion. Here is the stochastic differential equation (SDE) for GBM in the risk neutral world. 

\[
dS(t) = r S(t) \, dt + \sigma S(t) \, dW(t)
\]

The analytical solution for GBM is given by

\[
S(t) = S(0) \exp \left( \left( r - \frac{\sigma^2}{2} \right) t + \sigma W(t) \right)
\]

It is possible to generate the asset price at time $T$ using a single step. Since we wish to investigate variance reduction techniques ,
we opt to focus our investigation on the numerical solutions discussed in the following section (Euler Maruyama and Milstein). These numerical methods
require the full path to be simulated. Monte Carlo simulations using the analytical solution that have been provided in the code.

\subsection{Numerical Solutions}

In this section we present numerical schemes for the solution of the GBM SDE. 

\subsubsection{The Euler Scheme}

The Euler-Maruyama discretization is a numerical method used to approximate solutions to stochastic differential equations (SDEs). The Euler-Maruyama method approximates 
the solution of an SDE by discretizing time into small steps of size $\Delta t$. The discretized form of the SDE is given by:

\[
X_{t_{n+1}} = X_{t_n} + a(X_{t_n}, t_n) \Delta t + b(X_{t_n}, t_n) \Delta W_n
\]

where $\Delta W_n = W_{t_{n+1}} - W_{t_n} \sim \mathcal{N}(0, \Delta t)$ is a normally distributed random variable with mean 0 and variance $\Delta t$.

\para
Using the Euler-Maruyama method, the discretized form of GBM is:

\[
S_{t_{n+1}} = S_{t_n} + \mu S_{t_n} \Delta t + \sigma S_{t_n} \Delta W_n
\]

\subsubsection{The Milstein Scheme}

The Milstein Scheme improves upon the Euler-Maruyama method by adding a correction term involving the derivative of the diffusion coefficient. 
The discretized form of the SDE using the Milstein Scheme is given by:

\[
X_{t_{n+1}} = X_{t_n} + a(X_{t_n}, t_n) \Delta t + b(X_{t_n}, t_n) \Delta W_n + \frac{1}{2} b(X_{t_n}, t_n) \frac{\partial b(X_{t_n}, t_n)}{\partial X} \left( (\Delta W_n)^2 - \Delta t \right)
\]

For GBM, the derivative of the diffusion term $b(S_t, t) = \sigma S_t$ with respect to $S_t$ is $\frac{\partial b(S_t, t)}{\partial S} = \sigma$. Using the Milstein Scheme, the discretized form is:

\[
S_{t_{n+1}} = S_{t_n} + \mu S_{t_n} \Delta t + \sigma S_{t_n} \Delta W_n + \frac{1}{2} S_{t_n} \sigma^2 \left( (\Delta W_n)^2 - \Delta t \right)
\]

\newpage
\subsection{Variance Reduction Techniques}

The accuracy of a Monte Carlo simulation is measured by the standard error $\sigma / \sqrt{N}$. To improve the accuracy of a simulation, we can increase the number 
of random paths $N$ or reduce the standard deviation $\sigma$. Variance reduction techniques aim to reduce the standard error by reducing the variance of the simulated paths.

\subsubsection{Antithetic Variates}

Antithetic Variates leverage the fact that for every gaussian drawn, there is a corresponding negative variate which 
has the same probability of being drawn. If we draw variate $v_i = v(z_i)$ then we also use $v_i' = v(-z_i)$. $v_i'$ 
is negatively correlated to $v_i$ but has the same variance.\cite{jackel}

\[
\text{Var}\left( \frac{v_i + v_i'}{2} \right) = \frac{1}{2} \left( \text{Var}(v_i) + \text{Cov}(v_i, v_i') \right)
\]

Because $v_i$ and $v_i'$ are negatively correlated, $\text{Cov}(v_i, v_i') < 0$.

\[
\text{Var}\left( \frac{v_i + v_i'}{2} \right) < \frac{1}{2} \, \text{Var}(v_i)
\]

\subsubsection{Sobol Sequences}

Sobol Sequences are a type of low-discrepancy sequence used in numerical methods for generating quasi-random points. 
Unlike purely random sequences, which can have clusters and gaps, quasi-random sequences like Sobol Sequences are designed 
to fill the space more evenly. This results in more reliable and faster convergence in numerical simulations. The difference between
random numbers and Sobol Sequences is demonstrated in Figure \ref{fig:sobol}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{images/sobol.png}
    \caption{Sobol Sequence}
    \label{fig:sobol}
\end{figure}

\subsubsection{Brownian Bridge}

Brownian Bridge is a path construction method. Rather than building the Wiener path incrementally, the Brownian Bridge uses
the first variate $z_1$ to determine the terminal point $W_{t_n} = \sqrt{t_n}z_1$. The next variate $z_2$ is used to determine a 
point on the path $W_j$ conditional on points $W_{t_n}$ and $W_0=0$. This is repeated until the entire path is constructed. 

\[
W(T) = \sqrt{T}z_1
\]

\[
W(T/2) = \frac{1}{2}W(T/2) + \frac{1}{2}\sqrt{T}z_2
\]

\[
W(T/4) = \frac{1}{2}(W(T/2) + W(T)) + \frac{1}{2}\sqrt{T}z_4
\]

etc. The general formula for the Brownian Bridge is

\[
W(t_i) = (1 - \gamma)(W(t_l)) + \gamma W(t_m) + \sqrt{\gamma(1-\gamma)(m-l)\Delta t}z_i
\]

\para
Incremental and Brownian Bridge path constructions have the same variance so a similar rate of convergence is expected. The results show that 
the Brownian Bridge combined with a Sobol Sequence has a superior convergence rate. It was suggested by Markowitz\cite{markowitz} 
that the improvement in convergence is due to the reduction of the effective dimension of the problem.

\subsection{Results}

In this section, we present the results of pricing a European Call Option using the Euler approximation with the following variance reduction / path construction techniques

\begin{itemize}
    \item Antithetic Variates
    \item Sobol Sequences
    \item Brownian Bridge
    \item Sobol Sequences with Brownian Bridge
\end{itemize}

We replicate the workings of Sergei Kucherenko and Nishant Shah \cite{sergei} and use
the following parameters for the simulation: $S_0 = 100$, $K = 100$, $r = 0.05$, $\sigma = 0.2$, $T = 0.5$.
The Black-Scholes price of the option is 6.89.  128 steps are computed and the number of simulations
is varied from 2 to 256.  As expected, there is little difference in the convergence rates of incremental and Brownian Bridge path 
construction in the absence of variance reduction techniques. If we combine the Sobol Sequence with the Brownian Bridge, we see 
a significant improvement in convergence rate. Figure \ref{fig:option_price} shows the evolution of the price estimate price as the number
simulations is increased.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/option_price.png}
    \caption{European Call Option Price Convergence}
    \label{fig:option_price}
\end{figure}

\para
We also look at the root mean square error (RMSE). Each simulation is run $L=50$ times.

\[
RMSE = \sqrt{\frac{1}{L} \sum_{l=1}^{L} (V^l - V^{BS})^2}
\]

RMSE is plotted against the number of simulations in Figure \ref{fig:rmse}. When variance reduction techniques are
applied, the accuracy of the results is significantly improved by reducing the number of simulations needed to achieve
a desired level of accuracy.  According to the simulations, the convergence rate of the Brownian Bridge with Sobol Sequences
decreases as $1/N^{0.95}$.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/rmse.png}
    \caption{Root mean square error vs the number of simulations}
    \label{fig:rmse}
\end{figure}

\newpage
\newpage

\section{Hedging with actual or implied volatility}

In this section, the differences between hedging a portfolio of options with implied and actual volatility are studied.  The figures that follow have been created by 
studying the P\&L of a long option, short stock portfolio. The stock price is assumed to follow Geometric Brownian Motion and is generated using
the Milstein approximation using Sobol / Brownian Bridge variance reduction. It has initial price $S_0 = 100$. The option is a European Call with strike $K = 100$, risk free rate $r = 0.02$.
Actual volatility is taken to be $\sigma_a = 0.35$ and implied volatility $\sigma_i = 0.2$. The time to maturity is $T = 1$ and the number of steps to produce the stock path is $256$.
If the option is hedged with the actual volatility it has a theoretical P\&L of \$5.85

\para
Much of the following analysis is taken from CQF lecture notes and Quantitative Finance books authored by Wilmott \cite{wilmott}.

\subsection{Actual volatility}

By hedging with actual volatility, we are replicating a short position in a correctly priced option. The payoffs for the long option and the short replicated option will
exactly cancel.  The total profit from hedging with actual volatility is known and can be calculated as the difference between the actual and implied option price

\[
V(S, t; \sigma^a) - V(S, t; \sigma^i)
\]

To prove this, set up a long option short stock portfolio. The option is valued at $V^i$, and we hedge with $-\Delta^a S$ of the stock.
The portfolio is left for a short time period $\delta_t$ and revalued.  In the notation, superscript $a$ refers to actual
and, superscript $i$ refers to implied.  Dividends are ignored for brevity, but it is a small extension.

\para
'Today' at time $t$

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|}
        \hline
        \textbf{Component} & \textbf{Value} \\
        \hline
        Option & $V^{i}$ \\
        \hline
        Stock & $-\Delta^{a}S$ \\
        \hline
        Cash & $-V^{i} + \Delta^{a}S$ \\
        \hline
    \end{tabular}
    \caption{Portfolio at time $t$}
    \label{tab:portfolio_t}
\end{table}

\para
'Tomorrow' at time $t + \delta_t$
\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|}
        \hline
        \textbf{Component} & \textbf{Value} \\
        \hline
        Option & $V^{i} + dV^i$\\
        \hline
        Stock & $-\Delta^{a}S -\Delta^{a}dS$ \\
        \hline
        Cash & $(-V^{i} + \Delta^{a}S)(1 + r dt)$ \\
        \hline
    \end{tabular}
    \caption{Portfolio at time $t + \delta_{t}$}
    \label{tab:portfolio_t_plus_delta_t}
\end{table}

Mark to market we have made the following profit over one time step

\begin{center}
\begin{equation}
    dV^i - \Delta^a dS -(V^i - \Delta^a S) rdt
    \label{tab:eq1}
\end{equation}
\end{center}
If the option is priced using the actual volatility then the option is correctly valued at $V^a$, so it is written
\begin{center}
\begin{equation}
    dV^a - \Delta^a dS -(V^a - \Delta^a S) rdt = 0 
    \label{tab:eq2}
\end{equation}
\end{center}
Subtracting \ref{tab:eq1} from \ref{tab:eq2} the mark-to-market profit from $t$ to $t + \delta_t$

\begin{center}
\begin{align*}
    \ref{tab:eq1} - \ref{tab:eq2} & = dV^i - dV^a + r(V^a - \Delta^a S) dt - r (V^i - \Delta^a S) dt \\[2pt]
                                  & = dV^i - dV^a - r(V^i - V^a) dt \\[2pt]
                                  & = e^{rt} d(e^{-rt} (V^i - V^a)) \\[2pt]
    d(e^{-rt}V)                   & = d(e^{-rt} dV) -r e^{-rt} V dt \\[2pt]
                                  & = e^{-rt} (dV -rV dt) \\
\end{align*}
\end{center}


The present value of this profit at $t_0$ is

\[
    e^{-r(t-t_0)} e^{rt} d(e^{-rt} (V^i - V^a)) = e^{rt_0} d(e^{-rt} (V^i - V^a))
\]

So the total profit from $t_0$ to expiration is

\begin{center}
\begin{equation}
    e^{r(t_0)} \int_{t_0}^{T} d(e^{-rt} (V^i - V^a)) = V^a - V^i
\end{equation}
\end{center}


The profit is guaranteed, but how is it realised? Using
\para

i) It\^{o}'s lemma 

\[
dV = (\frac{dV}{dt} + \frac{1}{2} \sigma_a^2 S^2 \frac{d^2V}{dS^2}) dt + \frac{dV}{dS} dS
\]

\para
ii) Black-Scholes with $\sigma = \sigma_i$ and 

\[
\Theta^i + \frac{1}{2} \sigma_i^2 S^2 \Gamma^i + r (S \Delta^i - V^ii) = 0
\]

\para
iii) Geometric Brownian Motion as the path for the underlying asset


\[
dS = \mu S dt + \sigma_a S dX
\]

The profit of a single timestep can also be written as

\begin{center}
\begin{align*}
& \Theta^i dt + \Delta^i dS + \frac{1}{2} \sigma^2 S^2 \Gamma ^i dt - \Delta^a dS -r(V_i - \Delta^a S) dt\\[2pt]
&= \Theta^i dt + \mu S(\Delta^i - \Delta^a) dt + \frac{1}{2} \sigma^2 S^2 \Gamma^i dt - r (V^i - V^a) dt + (\Delta^i - \Delta^a) \sigma S dX\\[2pt]
&= (\Delta^i - \Delta^a) \sigma S dX + (\mu - r) S (\Delta^i - \Delta^a) dt + \frac{1}{2} (\sigma_a^2 - \sigma_i^2) S^2 \Gamma^i dt\\[2pt]
&= \frac{1}{2}( \sigma_a^2 - \sigma_i^2) S^2 \Gamma^i dt + (\Delta^i - \Delta^a) ((\mu -r) S dt + \sigma_a S dX)
\end{align*}
\end{center}


Figure \ref{fig:actual_volatility_hedging} illustrates how the theoretical P\&L ($V^a - V^i = 5.85$) can be realised. A couple of points to note:

\begin{itemize}
    \item Daily profit is random. This is accounted for by the $dX$ term.
    \item On a mark-to-market it is possible to lose money in spite of the theoretical profit being known.
    \item The final P\&L is not exactly the same as the theoretical profit because we hedge discreetly.
\end{itemize}

 
\begin{figure}[h]
\centering
\includegraphics[width=0.8\textwidth]{images/actual_volatility_hedging.png}
\caption{P\&L for a delta hedged option on a mark-to-market basis hedged with actual volatility}
\label{fig:actual_volatility_hedging}
\end{figure}

\subsection{Implied volatility}

Hedging with implied volatility is a more common practice since the daily profit is deterministic. The fluctuations in stock price with those in the option price are balanced.

\para
Consider the same portfolio as before, but hedge with $-\Delta^i S$ rather than $-\Delta^a S$. 

\para
The mark-to-market profit over one time step is

\begin{center}
\begin{align*}
& dV^i - \Delta^i dS -(V^i - \Delta^i S) rdt\\[2pt]
&= \Theta^i dt + \frac{1}{2} \sigma_a^2 S^2 \Gamma^i dt - r(V^i - \Delta^i S) dt\\[2pt]
&= \frac{1}{2}(\sigma_a^2 - \sigma_i^2) S^2 \Gamma^i dt
\end{align*}
\end{center}

Adding up the profit over all time steps and discount to the present day value, the total P\&L is obtained.

\[
    \frac{1}{2}(\sigma_a^2 - \sigma_i^2) \int_{t_0}^{T} e^{-r(t-t_0)} S^2 \Gamma^i dt
\]

Hedging with implied volatility has the following characteristics 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/implied_volatility_hedging.png}
    \caption{P\&L for a delta hedged option on a mark-to-market basis hedged with implied volatility}
    \label{fig:implied_volatility_hedging}
\end{figure}

\begin{itemize}
    \item The daily profit is deterministic - there are no $dX$ terms.
    \item The total profit is unknown, positive and highly path dependent.
    \item Small fluctuations in the P\&L are caused by discrete hedging.
\end{itemize}

These characteristics are visible in Figure \ref{fig:implied_volatility_hedging}. The P\&L distribution in Figure \ref{fig:pnl_distribution} illustrates the 
different payoff profiles.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/pnl_distribution.png}
    \caption{P\&L distribution for a delta hedged option on a mark-to-market basis hedged with actual and implied volatility}
    \label{fig:pnl_distribution}
\end{figure}

P\&L scales with $\Gamma_i$ (which is strictly positive for Call options). It's not expected to make much money in a trending market (large positive or negative drift)
where the Delta races to 1 or 0. The best outcome is for the spot to be close to the strike at expiration causing Gamma to spike. That said, the relationship isn't 
particularly straightforward. Daily PNL is approximated by 

\[
    \frac{1}{2}\Gamma_i S^2 ((\frac{\Delta S}{S})^2 - \sigma_i^2 dt)
\]

In Figure \ref{fig:gamma} the daily P\&L (smoothed over 5 days) evolves with the time-dependent Gamma as the stock price nose dives.
In the plot, negative daily P\&L is seen in conjunction with an increase in Gamma suggesting that there is a corresponding decrease in the local realised volatility. If 
the realised volatility is lower than the implied volatility, then realised P\&L will be negative over the timestep. 


\begin{figure}[h]
    \centering
    \subfigure[Caption for Figure 1]{\includegraphics[width=0.45\textwidth]{images/stock_vs_gamma.png}}
    \hfill
    \subfigure[Caption for Figure 2]{\includegraphics[width=0.45\textwidth]{images/gamma_pnl.png}}
    \caption{Caption for the combined figure}
    \label{fig:gamma}
\end{figure}
 
\newpage

\section{Minimum Variance Delta}

In this third and final section of the report Minimum Variance Delta (MVD) is studied. MVD is the Delta that minimizes the variance of a hedgers positions
by anticipating the change in the magnitude of implied volatility. A correction is then applied to the Black-Scholes Delta. 
A regression model for computing MVD was introduced by John C. Hull and Alan White in 2017 \cite{hull}. In their paper it is shown that 

\[
\delta_{MV} = \delta_{BS} + \frac{v_{BS}}{S \sqrt{T}} (a + b \delta_{BS} + c \delta_{BS}^2)
\]

and the expected change in implied volatility is given by

\[
E(\Delta \sigma_i) = \left ( \frac{a + b \delta_{BS} + c \delta_{BS}^2}{\sqrt{T}} \right ) \frac{\Delta S}{S}
\]

To determine the coefficients $a$, $b$ and $c$ the following regression model is used

\[
\Delta f - \delta_{bs} \Delta S = \frac{v_{BS}}{\sqrt{T}} \frac{\Delta S}{S} (a + b \delta_{BS} + c \delta_{BS}^2) + \epsilon
\]

$\Delta f$ is the change in the option price, $\Delta S$ is the change in the stock price and $\epsilon$ is the error term. $\delta_{BS}$ and $v_{BS}$ are the Black-Scholes 
Delta and Vega respectively.    

\subsection{Data}

End of day SPX options data from OptionsDX is used. The data contains; bid, ask, strike, days to expiry, implied volatility, delta, gamma, theta, vega. It is assumed
that the greeks are calculated using the Black-Scholes model. The mid price is calculated and used as the option price for all analysis. The vega quoted is the 1\% 
change in implied volatility, so it is scaled up by 100.  The paper suggests that this approach is most effective for out of the money options so the data has been restricted to
three moneyness levels; 50\%, 40\% and 30\%. The regression is also run across different expiry horizons; 1M, 3M, 6M, 9M and 12M.  In spite of these, the accompanying
code can be run on the full dataset (e.g all moneyness levels, calls and puts, and all expiries).

\subsection{Results}

The regression model is fitted to the data and the coefficients $a$, $b$ and $c$ are calculated.  Figure \ref{fig:a_b_c} illustrates how $a$, $b$ and $c$ evolve using a 15-day rolling window.
Rolling estimation accounts for changing environments and can reflect regime changes, for example, the spike in March 2023 is likely caused by the Silicon Valley Bank crash.  The parameters are
two orders of magnitude larger than those found by Hull and White. This is likely due to do the fact that S\&P levels are now 5 times higher than they were in 2014. Similar to Hull and White
\cite{hull} it's uncovered that, for call options, $a$ and $b$ are mirror images.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/a_b_c.png}
    \caption{Estimated parameters for a, b, and c for calls in 2023 in the 40 delta, 3M expiry bucket using a 15-day rolling window}
    \label{fig:a_b_c}
\end{figure}

As expected, it's discovered that the Minimum Variance Delta is lower than Black-Scholes Delta in all the cases studied. In Figure \ref{fig:mvd-bs} it's shown that
$\delta_{MV}$ - $\delta_{BS}$ gives a parabolic shape (inverted for longer dated options). This suggests the quadratic fitting recipe is a good approximation.
The expected change in implied volatility in Figure \ref{fig:eiv} against Delta shows a similarly parabolic shape.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/mvd-bs.png}
    \caption{Delta MVD - Delta BS for the 30, 40 and 50 Delta buckets for 1M, 3M, 6M, 9M and 12M tenors}
    \label{fig:mvd-bs}
\end{figure}


\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{images/eiv.png}
    \caption{Expected change in implied volatility for the 30, 40 and 50 Delta buckets for 1M, 3M, 6M, 9M and 12M tenors}
    \label{fig:eiv}
\end{figure}


Sum of square errors (SSE) quantifies how well the regression model fits the data. 
Specifically, it measures the total deviation of the predicted values from the actual values. A higher SSE indicates a worse fit as it
deviates further from the actual values. 

\para
The SSE hedging error for Black-Scholes Delta and Minimum Variance Delta is compared. The hedging
error for Minimum Variance Delta is 

\[
\epsilon_{MV} = \Delta f - \delta_{BS} \Delta S - lta S = \frac{v_{BS}}{\sqrt{T}} \frac{\Delta S}{S} (a + b \delta_{BS} + c \delta_{BS}^2)
\]

and the hedging error for Black-Scholes Delta is

\[
\epsilon_{MV} = \Delta f - \delta_{BS} \Delta S
\]

The gain (the model improvement) is therefore 

\[
Gain = 1 - \frac{SSE(\epsilon_{MV})}{SSE(\epsilon_{BS})}
\]

In Table \ref{tab:gain} the gain in model accuracy is shown for different moneyness levels and expiries. It further confirms that the Minimum Variance Delta model
is superior to the Black-Scholes Delta model reporting gains in all cases. It also confirms that better performance for out of the money options seeing a gain of
18.4\% for 50\% moneyness options with 1M expiry.

\begin{table}[ht]
    \centering
    \caption{Gain in model accuracy}
    \label{tab:gain}
    \begin{tabular}{|c|c|c|c|c|c|}
        \hline
         &1M & 3M & 6M & 9M & 12M \\
        \hline
        50\% &  8.7 &  5.7 &  3.9 &  3.8 & 1.8 \\
        40\% & 13.3 & 11.6 &  7.2 &  5.4 & 3.8 \\
        30\% & 18.4 & 21.5 & 13.9 & 10.5 & 8.4 \\
        \hline
    \end{tabular}
\end{table}


\begin{thebibliography}{9}
\bibitem{hull}
J. Hull, A. White. \textit{Optimal delta hedging for options}. 2017
\bibitem{sergei}
S. Kucherenko, N. Shah \textit{The Importance of being Global. Application of Global Sensitivity Analysis in Monte Carlo Option Pricing}.
\bibitem{jackel}
P. J{\"a}ckel \textit{Monte Carlo Methods in Finance}.
\bibitem{markowitz}
B. Moskowitz, R.E. Caflisch. \textit{Smoothness and Dimension Reduction in Quasi-Monte-Carlo}
\bibitem{wilmott}
P. Wilmott. \textit{Paul Wilmott on Quantitative Finance. Volume 1.}
\end{thebibliography}
\end{document}

